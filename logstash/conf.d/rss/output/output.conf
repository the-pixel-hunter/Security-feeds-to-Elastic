#Output config for all RSS feeds, also hashes the title to use as ID so duplicates arent created

	# Calculate the age of the article from the current date
	ruby{
		code => "event.set('[rss][article][age]', Time.now.to_f - event.get('@timestamp').to_f"
	}
	# 7 represents the number of days to allow.
	if "[rss][article][age]" > (60 * 60 * 24 * 7) {
		drop{}
	}
	# Generatets a fingerprint which is used as the document ID to prevent duplicates forming within elastic 
	fingerprint{
		source => ["[rss][article][url]"]
		target => "[@metadata][fingerprint]"
		method => "MURMUR3"
	}
}

output{
	elasticsearch{
		index => "intel-rss"
		document_id => "%{[@metadata][fingerprint]}"
		pipeline => "rss_to_elastic"
		username => "intel_ingest"
		password => "changeme"
	}
}
